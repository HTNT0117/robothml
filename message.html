<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Message Screen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    html, body { margin:0; padding:0; width:100%; height:100%; overflow:hidden; }
    #messageScreen {
      display:flex; flex-direction:column;
      justify-content:center; align-items:center;
      position:fixed; top:0; left:0;
      width:100vw; height:100vh;
      box-sizing:border-box; padding:20px;
    }
    #messageScreen::before {
      content:""; position:absolute; top:0; left:0;
      width:100%; height:100%;
      background:url('img/sad.png') center/cover fixed;
      filter:blur(4px) brightness(0.4); z-index:0;
    }
    #messageScreen.face-bg::before {
      background:url('img/face.png') center/cover fixed;
      filter:blur(4px) brightness(0.4);
    }
    #messageText {
      position:relative; z-index:1;
      font-size:clamp(1rem,2.5vw,2.5rem);
      line-height:1.4; color:#00ffe8;
      text-shadow:0 0 8px rgba(0,255,232,0.8),0 0 16px rgba(0,255,232,0.6);
      background:rgba(0,0,0,0.4); backdrop-filter:blur(6px);
      padding:1rem 1.5rem; border-radius:.75rem;
      max-width:80%; text-align:center; white-space:pre-wrap;
      margin-bottom:2rem;
    }
    .flex-top {
      position:fixed; top:20px; left:20px; z-index:1001;
      display:flex; align-items:center; gap:.5rem;
      cursor:pointer;
    }
    .flex-top i { color:#0081AF; }
    .flex-top p {
      color:#0081AF; margin:0; font-size:1rem;
    }
  </style>
</head>
<body>
  <div id="messageScreen">
    <p id="messageText"></p>
    <div class="flex-top" onclick="stopChitchat()">
      <i class="fa-solid fa-angle-left fa-6x"></i><p>Quay lại</p>
    </div>
  </div>

  <script src="https://kit.fontawesome.com/54a1468923.js" crossorigin="anonymous"></script>
  <script>
    const messages = [
      "Tôi hiểu rằng bạn đang cảm thấy rất buồn và thất vọng. Điều này thật sự khó khăn, nhưng nhớ rằng đôi khi chúng ta cần phải nghỉ ngơi để lấy lại năng lượng và tinh thần. Bạn hoàn toàn xứng đáng có một khoảng thời gian để hồi phục.",
      "Khi công việc dồn dập, chúng ta dễ cảm thấy bực bội. Một trong những cách hiệu quả để giảm bớt cảm giác này là chia nhỏ công việc thành những nhiệm vụ nhỏ hơn, việc hoàn thành từng phần công việc nhỏ sẽ giúp bạn cảm thấy dễ chịu hơn. Bạn cũng có thể thử đặt ra một khoảng thời gian cụ thể để nghỉ ngơi giữa các công việc, điều này đã được nhiều chuyên gia tâm lý khuyên dùng để giảm căng thẳng."
    ];
    let msgIndex = 0;

    // Chờ parent gửi start-message mới chạy
    window.addEventListener('message', e => {
      if (e.data && e.data.type === 'start-message') {
        const el = document.getElementById('messageText'),
              msgS = document.getElementById('messageScreen');

        // đổi background nếu message thứ 2
        msgS.classList.toggle('face-bg', msgIndex === 1);

        // show và điền text
        msgS.style.display = 'flex';
        el.textContent = messages[msgIndex];

        // sau 7s, báo parent chuyển màn và tăng index
        setTimeout(() => {
          window.parent.postMessage({ type: 'next-screen' }, '*');
          msgIndex++;
        }, 7000);
      }
    });

    function stopChitchat() {
      document.getElementById('messageScreen').style.display = 'none';
      window.parent.postMessage({ type: 'next-screen' }, '*');
    }
  </script>
</body>
</html>
